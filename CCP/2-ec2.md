EC2

os는 윈도우,리눅스,맥os를 사용할 수 있다.

Ec2 user data로 ec2 시작시, 유저가 원하는 셋팅으로 셋팅 할 수 있다. -> 부트스트래핑 - 머신이 작동할때 명령을 시작
인스턴스를 시작할때, 딱 한번만 작동한다.

인스턴스는 중지면 비용은 안나감 하지만 EBS는 연결되어있음

m5.2xlarge

m은 인스턴스 클래스
5는 인스턴스 세대

2xlarge는 인스턴스 사이즈 클래스

컴퓨터 클래스 c시리즈
- 배치작업
- 일괄처리
- 미디어 트랜스 코딩
- HPC 머신러닝 등

메모리 m시리즈
- 고성능 DB
- 분산 웹 캐쉬서버
- 인메모리 디비
- 리얼타임 비정형 데이터 처리
  
스토리지 최적화 I G H1 시리즈
- 대규모 데이터셋 접근
- 고주파 처리 OLTP 시스템
- 관계형 nosql 디비
- 레디스 같은 캐쉬 인메모리
- 데이터 웨어하우스 어플리케이션
- 분산 파일 시스템 - 하둡

------------
보안그룹
ec2 port에 대한 접근을 제어하는것
ip4 and ip6기반으로 작동
여러 인스턴스에 연결할 수도 있음
VPC 리젼과 결합되어 통제됨 - > 리전을 전환하면, 새로만들어야함
Ec2 외부의 방화벽이므로, ec2는 알 수 없음

ec2 ssh연결에 타임아웃이 걸리면 -> 보안 그룹 문제
connection refused면 -> 보안그룹은 실행 됫지만, 키나 애플리케이션 문제임

인바운드 : 패킷 들어오는거, 기본값으로 22번 포트만 뚫림
아웃바운드 : 패킷 나가는거, 기본값으로 다 나감


22포트 ssh 또는 SFTP
21포트 FTP
80 http
443 https
3389 RDP remote desktop protocol 원격제어

----------
ec2 구매 옵션

온디멘드 - 단기 워크로드, 가격을 예측할 수 있고
리눅스와 윈도우만 초단위 요금, 그외 os는 시간당 요금
가격은 비싸지고 할인은 없지만, 약정도 필요없고, 1분안에 올릴수 있음


예약 인스턴스 - 장기 워크로드
1~3년
컨버터블 예약 인스턴스 장기간의 탄력성 있는 인스턴스?
-> 인스턴스 제품군과 , 운영체제 등을 변경 가능함 -> 할인율 줄어듬





세이빙 플랜
1~3년
인스턴스 유형의 약정이 아니라, 특정 사용량을 달러로 지불
아~ 요금 총합!!!! 뭘쓰든 상관없다!!!!!
초과 사용량은 온디멘드 가격으로 나옴


스팟
단기 워크로드, 싸지만 신뢰성이 낮음


전용 호스트
물리적 서버 전체 예약
기존의 서버 결합 소프트웨어 라이선스를 사용해야 될 경우
요금은 소켓당,코어당,vm 소프트웨어 라이선스당 청구됨
온디멘드나 예약 1~3년 할수이슴
물리적 서버 자체에 액세스


전용 인스턴스 
일반 인스턴스처럼 하드웨어 공유 X, AWS
내 전용 하드웨어에서 실행됨, 물리적 서버인 전용 호스트와는 다름
인스턴스 배치는 제어 할 수 없음

용량 예약 
특정한 AZ의 용량을 원하는기간동안 예약 가능
취소할수 있고, 할인은 없음 -> 세이빙 플랜이나 예약 인스턴스랑 결합해야됨

----

ec2 인스턴스 스토리지

ccp레벨에서는 EC2에는 하나의 EBS만 마운트 가능

또한 EBS는 AZ에 종속된다.
us-east-1a에서 생성된 EBS는 
us-east-1b에는 있는 EC2와 연결 불가능
하지만 스냅샷을 사용하면 연결 가능함

EBS볼륨은 물리적 드라이버가 아니라!!!! 네트워크 드라이버다!!!!!
EBS는 네트워크 드라이버라, ec2인스턴스에서 분리 될 수 있고, 다른 ec2에 연결 가능하다
------------
EBS 스냅샷
원하는 시점의 EBS 백업
`EBS 스냅샷 아카이브`는 S3와 S3 글래셔라고 생각하면됨
아카이브 저장소가 75% 쌈, 단 아카이브에서 복구하는데 24~72시간 걸림 

--------
AMI 
아마존 머신 이미지

ec2 시작시, os 부터 소프웨어까지 니 맘대로 설정 가능함

-------------
EC2 이미지 빌더

깃랩 cicd처럼 AMI를 빌드하고 테스트까지 해줌, Ec2 쓴다

-------------
인스턴스 스토어
고성능 EBS? 하드디스크
특정 유형의 Ec2인스턴스는 해당하는 물리적 서버에 연결된 하드웨어를 가르킴
하지만 인스턴스를 중지하면 사라짐 - 장기적으로 데이터를 보관하진 않음
버퍼, 캐시, 비정형 데이터 일때 사용하는 것이 좋음
물리적으로 연결되있으므로 장애 발생시, 데이터 손실 위험이 있음

i3시리즈가 인스턴스 스토어를 사용함

-----------------------
EFS
파일 네트워크 시스템
하나가 수백개의 EC2에 연결 될 수 있음
EFS는 리눅스 인스턴스만 사용할 수 있고, 멀티 AZ가 가능함
대신, EBS 3배가량 비쌈, 단, 사용량에 따라 비용 지불
EFS 이더넷 카드로 마운트 가능



EFS-IA (infrequent access)
파일 엑세스 빈도에 따라 EFS에서 파일을 EFS-IA로 이동시킴
그냥 EFS보다 92프로 쌈 -> 걍 EFS계의 s3 글래셔

EBS 공동 책임 모델
EBS,EFS 하드웨어를 복제를 실행하거나, 작동하지 않으면 AWS 책임


데이터 손실되지 않게 백업,스냅샷 뜨는건 내책임
데이터 암호화도 내책임
드라이브에 설정하는 모든 데이터는 내책임
인스턴스 스토어 스토리지에 대한 이해 내책임

AWS FsX
AWS에서 타사의 고성능 파일 시스템을 얻는 관리형 서비스
고성능 파일 시스템임!!!!!
GCP나 애져 스토리지 연동 서비스 인듯 X
윈도우 파일서버, 리눅스 클러스터 서버 -> HPC나 기업에서 사용하기 적당함
이거 왜씀? -> EFS나 EBS는 AWS 인스턴스 대상이지만, Fsx는 내컴퓨터에서도 접근 가능하기 때문임
















