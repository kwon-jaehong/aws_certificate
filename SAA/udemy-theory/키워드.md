## 기타 

- 원격 데스크톱 연결 포트는 3389
  - Microsoft RDP(원격 데스크톱 프로토콜)

- `내결함성` : AWS가 사용자의 애플리케이션 또는 서비스가 네트워크 또는 하드웨어 장애 등으로 인해 중단되지 않고 항상 가용성과 성능을 유지할 수 있는 능력을 갖추었다는 의미입니다.

- `AWS Backup은 AWS 리소스에서만 작동`


---------------------------------------
## VPC 관련

- AZ간의 모든 트래픽은 `암호화` 됨
-  네트워크 ACL에서 소스 0.0.0.0/0의 포트 443에서 인바운드 TCP 연결을 허용하고 포트 `32768 - 65535에서 대상 0.0.0.0/0으로의 아웃바운드` TCP 연결을 허용하도록 규칙을 업데이트합니다.
   - `리눅스 윈도우 임시포트`

- VPC를 생성할 때 CIDR 블록 형식으로 VPC에 대한 `IPv4 주소 범위를 지정해야`, `Ipv6도 설정 가능`
- VPC endpoint를 `AWS PrivateLink`라고도 부름
- 서브넷이 특정 경로 테이블과 명시적으로 `연결되지 않은 경우` 서브넷은 `기본 경로 테이블과 암시적으로 연결`

- `보조 ENI는 설정만`하면, Ec2가 다운되더라도, 다른 Ec2에 자동적으로 옮기는 기능 있음

- 보안 그룹은 `허용만 됨, 거부는 없음`

- VPC 공유(Resource Access Manager)를 사용하면, 계정간 VPC의 `하나 이상의 서브넷이 공유됨`

- 퍼블릭 서브넷에서 EC2 인스턴스 네트워크 주소 변환을 수행하는 엔티티는 `인터넷 게이트웨이`이다

- VPC 엔드포인트 = 프라이빗 링크는 `다른 VPC 서비스도 연결 가능함`(꼭 AWS 서비스 아니여도 됨)


---------------------------------
## EC2


- `http://169.254.169.254/latest/meta-data/`로 Ec2 인스턴스의 퍼블릭,프라이빗 IP 정보 등을 확인 할 수 있다.
  - 169.254.169.254 주소는` 링크 로컬 주소이다`
  - https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html



- ec2 자세한 모니터링은 메모리 사용량에 대한 지표를 제공하지 않음, 더 높은 지표 빈도(`1분 빈도`)만 제공
- Ec2는 중지(종료 아님)하면, `ENI와 EIP는 해제되지 않음`


- Ec2 클러스터 배치 그룹배정이 실패하면, `배치그룹에서 인스턴스를 중지했다가 다시 시작하면 됨` (용량 부족 오류)
- `최대 절전 모드는 Ec2생성후 수정이 안됨 (다시 ec2 만들어야함)`

- AMI가 `스냅샷을 기반`으로 하기 때문에 이동한 리전에 `자동으로 스냅샷이 생성`


- 오토스케일링 축소시, 제거대상 1순위는 `가장 오래된 시작구성에서 시작된 Ec2`
- Auto Scaling 그룹(ASG)이 비정상 Amazon EC2 인스턴스를 `즉시 종료`하지는 않음
  - 상태를 좀더 지켜봄
- `AZ 분배 재조정할 때` 이전 인스턴스를 종료하기 전에 `새 인스턴스를 시작하므로` `재조정으로 인해 애플리케이션의 성능이나 가용성이 손상되지 않음`
- Auto Scaling은 `비정상 인스턴스를 먼저 종료한 다음 새 인스턴스를 시작`


- 전용 호스트,인스턴스는 둘다 비슷하다
  - 물리적 장비를 직접 빌림
  - 랙을 통째로(호스트) 빌리느냐, 단순 CPU만 빌리느냐 차이임
- 전용 인스턴스 & 호스트 설정하는 방법은 VPC `테넌시 설정, ASG 테넌시 설정이 있다`


------------------------------
## ELB

- ELB는 기본적으로 하나의 리전 내에서만 동작하며, `멀티 리전 트래픽 분배를 지원하지 않음`

- `ALB`에 `탄력적 IP 주소를 할당할 수 없음`
- `ALB 엑세스 로그 활성화` 하면, 들어오는 트래픽, ip 주소등을 로그로 남길 수 있다
- ALB는 `지리적 위치를 알 수 없음` (규칙 구성 못함)
- ALB에서 `ICMP 상태 확인 및 FTP 상태 확인 은 지원되지 않음`
- ALB는 `서비스의 CPU사용률이나 메모리 사용량을 알 수 없음!`

- Route 53은 `최상위 노드에 대한 CNAME 레코드는 생성할 수 없음`.
  - 별칭으로는 생성 가능
  - 별칭 `O`  : covid19survey.com -> www.covid19survey.com
  - CNAME `X` : covid19survey.com -> www.covid19survey.com

- NLB로 Ec2 인스턴스 ID를 NLB의 대상으로 지정하면, `기본 프라이빗 IP`주소로 맵핑&라우팅 됨

--------------------------------------
## EBS & EFS


- EFS나 EBS는 AWS 인스턴스 대상이지만, `Fsx는 내 컴퓨터에서도 접근 가능`
-  EFS 파일 시스템의 파일 및 디렉터리는 `사용자 ID 및 그룹 ID를` 기반으로 표준 Unix 스타일 읽기, 쓰기 및 실행 권한을 지원
- EBS 스냅샷 진행동안 `볼륨에 대한 지속적인 읽기 및 쓰기` 가능함
- Ec2가 `실행중`이여도, EBS 자동 삭제 `해제 할 수 있음`
  - 단, `AWS CLI 써야함`

-----------------------------------------
## RDS 



- RDS 다중 AZ 배포는, `동일 리전에서 이루어짐` (다른 리전이 아님)
- `지역 간 다중 AZ 배포와 같은 것은 없음`
- RDS에서 TED(투명한 데이터 암호화)는 저장된 데이터 암호화에 사용됨
- RDS 읽기 복제본은 `다른 AZ에서도 생성 가능`
-  RDS의 가용성을 향상시키는 데 `읽기 전용 복제본을 사용할 수 없슴`,`다중 AZ 구성`을 사용해야 고가용성임
- https://aws.amazon.com/ko/rds/features/read-replicas/?nc1=h_ls
- RDS의 `읽기복제본은 장애복구와 상관없음` (단지 읽기 능력 향상임)

- 다중 AZ 배포
  - `자동 백업`을 사용하면 백업이 예비 DB에서 이루어지기 떄문에 `기본 DB` 계속적으로 사용 가능
  - RDS OS 업데이트는 -> 예비 DB 업데이트 -> 예비 DB 승격 -> 기본DB가 `예비DB로` 바뀜 -> 예비 DB OS 업데이트
  - RDS 엔진 업데이트는 `기본,예비 DB 동시에 진행됨` (다운 타임 발생)

- 레드쉬프트는 콘솔에서 `다계정 데이터 공유`를 할 수 있음

![Alt text](../../etc/image2/RDS%20%EB%8B%A4%EC%A4%91%20%EB%A6%AC%EC%A0%84.png)



----------------------------
## 오로라

- 오로라 읽기 복제본 승격 기준
  - 계층이 우선 순위임(낮을수록)
  - 우선 순위를 같으면면 디스크 크기가 가장 큰 복제본을 승격
  예) 계층 1(32TB),계층 15(32TB),계층 1(16TB),계층 10(16TB)
    - 계층 1(32TB)가 승격됨

-----------------------------
## S3

- S3는 `정적 콘텐츠만 제공할 수 있음`
- S3에서 IA 수명주기 적용하려면, 최소 30일 이상 저장해야 한다는 S3의 제약 조건이 있음
  - `3일 뒤에 IA 전환같은 수명주기는 못씀` 
  - `Glacier는 언제든지 이동 가능!`
- S3 액세스 로깅, 정적 웹사이트 호스팅 및 요청자 지불 기능은 활성화된 후에도 `비활성화할 수 있슴`
- 하지만 버저닝은 활성화하면, `일시중지`만 가능
- S3 Transfer Acceleration로 업로드 하면 `전송 비용 나감`
- S3 알림 이벤트는 `표준 SQS 대기열만 Amazon S3 이벤트 알림 대상으로 허용되는 반면 FIFO SQS 대기열은 허용되지 않음`
  - FIFO 대기열 사용할라믄, 이벤트 브릿지와 같이 쓸것

- S3에서 버저닝이 활성화 되고, 새 개체를 성공적으로 쓰거나 기존 개체를 덮어쓴 후 후속 읽기 요청은 `최신 버전 객체로 반환`


- S3 정적 웹사이트 주소 형식
  - http://bucket-name.s3-website`.`Region.amazonaws.com
  - http://bucket-name.s3-website`-`Region.amazonaws.com

- 단일 개체의 다른 버전은 `다른 보존 모드 및 기간`을 가질 수 있음


![Alt text](../../etc/image2/s3%20%EC%88%98%EB%AA%85%20%EC%A3%BC%EA%B8%B0.png)

------------------------------
## 권한 및 감사 관련 (IAM 클라우드 트레일 등)

- IAM 사용자 암호의 최소 길이를 12자를 체크하려면, `AWS config` 사용해서 규칙을 정하면 됨
  - CloudTrail은 암호를 변경한 `사용자만 체크 가능`하고, `12자리를 지켯는지는 알 수 없음`
- `IAM 교차 계정 액세스`를 사용하면, 개별 AWS 계정에서 `리소스에 대한 관리 제어를 유지`하고 해당 리소스가 다른 부서와 분리할 수 있음
-  IAM 권한 경계는 IAM 그룹이 아닌 `역할 또는 사용자에게`만 `적용`할 수 있습니다.


- 기본적으로 CloudTrail 이벤트 로그 파일은 `Amazon S3 서버 측 암호화(SSE)를 사용하여 암호화`됩니다.


- 루트 계정만이 `AWS 계정 폐쇄, S3 MFA 삭제 활성화` 가능



- GuardDuty는 `Ec2에서 암호화폐 관련된 작업을 탐지` 할 수 있음
- GuardDuty는 `서비스를 비활성화`하면 모든 데이터가 삭제



- AWS Config에서 `AWS 리소스에 태그 안단것도 규칙으로 정할 수 있음(강제 태그 할당하게 하기)`
- AWS Config에서 서비스 할당량을 확인하는 `"관리형 규칙"은 없음`

- `CloudTrail은 따로 기록(영구저장)` 설정 해줘야함, 안그러면 90일 까지만 AWS 관리이벤트 유지됨

----------------------
## CloudFront & Global Accelerator

- CloudFront에 `데이터를 저장할 수 없다`.
- CloudFront는 `DynamoDB를 오리진으로 사용 할 수 없음`

- CloudFront는 Amazon S3 오리진에 인증된 요청을 전송하는 `두 가지 방법`으로 오리진 액세스 제어`(OAC)`와 오리진 액세스 ID`(OAI)`를 제공
  - OAI(Origin Access Identity)라는 특수 `CloudFront 사용자를 생성`하고 이를 배포와 연결합니다.
  - `OAC는 S3 객체에 대한 액세스` 권한을 관리하며, `OAI`는 `CloudFront와 함께 사용`하여 S3 버킷과 CloudFront 사이의 보안을 강화하는데 도움이 됩니다.


- `클라우드 프론트 프록시 메소드 PUT/POST/PATCH/OPTIONS/DELETE는` 오리진으로 직접 이동
- 클라우드 프론트 CDN은 `1GB 이하에서만 효과`, 1GB이상이면  S3 Transfer Acceleration로 웹사이트 호스팅이 나음

- 클라우드 프론트 오리진에서 `데이터 가져오는것은 무료임`




- 여러 리전에 여러 리소스가 있는 경우 `AWS Global Accelerator를 사용하여 IP 주소 수를 줄일수 있음`

- AWS Global Accelerator를 사용하면 클라이언트 디바이스 및 인터넷 해석기의 `DNS 캐싱`에 영향을 받지 않고 블루 환경과 그린 환경 간에 또는 그 반대로 점진적으로 또는 한 번에 트래픽을 이동할 수 있으며, 트래픽 다이얼 및 엔드포인트 가중치 변경은 몇 초 내에 적용됩니다.

- AWS Global Accelerator 지연 시간 및 네트워크 상태에 따라 `가장 가까운 AWS 엣지 로케이션으로 트래픽을 자동으로 라우팅`
- AWS Global Accelerator도 `장애 조치 기능`이 있음

----------------------------------
## 보안

- SSE-KMS는 객체 데이터만 암호화합니다. 개체 `메타데이터는 암호화되지 않습니다`.
  - 또한 `언제 누구에 의해 사용되었는지 보여주는 감사 추적을 제공`
- SSE-C는 `감사추적 제공 안함`


- AWS Key Management Service(AWS KMS)에서 고객 마스터 키(CMK)를 삭제하는 것은 위험합니다.` 따라서 AWS KMS는 대기 기간을 적용`합니다. 
- `AWS KMS에서 CMK를 삭제하려면 키 삭제를 예약`합니다. 대기 기간은 최소 7일에서 최대 30일까지 설정할 수 있습니다. 기본 대기 기간은 `30`일입니다. 

----------------
## 데이터 스토리지 및 이동 관련




- AWS Storage Gateway는 `로컬에 파일이 남아있음` (캐쉬)
- Storage Gateway를 사용하여 온프레미스에서 AWS로 데이터를 복사할 수 있지만 `대규모 데이터 세트를 AWS로 전송하는 데는 적합하지 않음`

- Storage Gateway에서 파일 공유를 사용한다는 것은 `온프레미스 시스템을 계속 유지하고` 완전히 마이그레이션하지 않는다는 것을 의미합니다.
- FSx for Lustre는 `매우 비쌈 `( EFS < FSx for Lustre )


|| DataSync | Storage Gateway |
|------|---|---|
|용도|온프레미스 데이터 이동| 하이브리드 클라우드 스토리지|
|Glacier Deep Archive 바로 저장|`지원`|미지원|


-----------------
## 서버리스 & 디커플링

- Lambda 함수는 설정하면, `URL로도 호출 할 수 있다`.

-  AWS Elastic Beanstalk는 `애플리케이션 파일은 S3에`, 서버 `로그 파일`은 `선택적으로 S3 또는 CloudWatch Logs에 저장`

- SNS는 처리량 무한임 -> 오토스케일링

--------------
## 클라우드 워치 & 이벤트 브릿지

- `EventBridge 규칙을 설정하여 S3 객체 PUT 작업을 감지`








